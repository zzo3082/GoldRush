@using Test_Login.Models
@using Microsoft.AspNet.Identity
@using Test_Login.Models.Extensions;
@{
    List<message>
    messageList = ViewBag.messageList;
}
@{
    Layout = "~/Views/Shared/_LayoutRight.cshtml";
}
<style>
    .btnEdit, .btnDelete {
        background-color: white;
    }

    body {
        background-color: #f7f7f7;
    }

    .myPhoto {
        /*height: 500px;*/
        width: 60%;
    }

    .msg {
        /*        border: 2px solid #007bff;
        border-radius: 21px;*/
        margin: 10px;
        padding: 10px;
        /*        -webkit-box-shadow: -10px 0px 13px -7px #000000, 10px 0px 13px -7px #000000, 4px 7px 7px 1px rgba(138,138,138,0);
        box-shadow: -10px 0px 13px -7px #000000, 10px 0px 13px -7px #000000, 4px 7px 7px 1px rgba(138,138,138,0);*/
        box-shadow: 1px 1px 9px 1px #A6A6A6;
        -webkit-box-shadow: 1px 1px 9px 1px #A6A6A6;
        -moz-box-shadow: 1px 1px 9px 1px #A6A6A6;
        -o-box-shadow: 1px 1px 9px 1px #A6A6A6;
    }

    .div_shadow {
        box-shadow: 0 10px 30px -15px rgb(0 0 0 / 75%);
    }

    #newItem {
        font-size: 30px;
        width: 150px;
        height: 50px;
    }

    .msginfo {
        height: 50px;
        border-radius: 21px;
        margin: 20px;
        padding: 10px;
    }

    #hashtagBox {
        margin: 10px;
        padding: 0px;
        height: 60px;
    }

    #hashtag > i {
        top: 5px;
    }

    #thinking {
        position: relative;
        top: 5px;
    }

    .btnSearch {
        position: relative;
        display: inline-block;
        top: 8px;
    }

    .rpl {
        /*        border: 2px solid #77c8ab;*/
        margin: 10px;
        /*        border-radius: 21px;*/
        padding: 10px;
        box-shadow: 1px 1px 9px 1px #A6A6A6;
        -webkit-box-shadow: 1px 1px 9px 1px #A6A6A6;
        -moz-box-shadow: 1px 1px 9px 1px #A6A6A6;
        -o-box-shadow: 1px 1px 9px 1px #A6A6A6;
    }

    .torpl {
        /*        border: 2px solid #e48489;*/
        margin: 20px;
        /*border-radius: 21px;*/
        padding: 20px;
        /*box-shadow: 1px 1px 9px 1px #A6A6A6;
        -webkit-box-shadow: 1px 1px 9px 1px #A6A6A6;
        -moz-box-shadow: 1px 1px 9px 1px #A6A6A6;
        -o-box-shadow: 1px 1px 9px 1px #A6A6A6;*/
    }

    .btnRelpy {
        position: relative;
        display: inline-block;
        height: 30px;
        vertical-align: middle;
    }

    .myTag {
        height: 30px;
        /*        width: 88px;*/
        text-align: justify-all;
        line-height: 0px;
    }

    .btnRelpy p {
        line-height: 0px;
        vertical-align: middle;
    }
    /*Toggle Switch*/
    input[type=checkbox] {
        height: 0;
        width: 0;
        visibility: hidden;
    }

    label {
        width: 20px;
        height: 20px;
        top: 10px;
        display: inline-block;
        border-radius: 10px;
        position: relative;
    }

    hr {
        background-color: gray;
        height: 1px;
        border: none;
    }

    /*Dropdown*/
    .dropbtn {
        /*background-color: #4CAF50;*/
        color: white;
        padding: 0px;
        width: 20px;
        height: 20px;
        font-size: 16px;
        border: none;
        cursor: pointer;
    }

        .dropbtn:hover, .dropbtn:focus {
            background-color: #3e8e41;
        }

    .dropdown {
        position: relative;
        display: inline-block;
        border-radius: 10px;
    }

    .img-res:hover {
        cursor: pointer;
        transform: scale(1.15);
        box-shadow: 2px 2px 5px rgba(0,0,0,0.8);
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f9f9f9;
        min-width: 68px;
        overflow: auto;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    }

        .dropdown-content button {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

    .dropdown a:hover {
        background-color: #f1f1f1
    }

    .show {
        display: block;
    }

    .none {
        display: none;
    }
    /*Dropdown*/
    label img {
        top: -10px;
    }
    /*條件搜尋*/
    /*    #hashtagStock{
        width:50px;
    }*/
    .dddd {
        display: inline-block;
    }

    .search {
        position: relative;
        display: inline-block;
    }

    #Table {
        position: absolute;
        background-color: white;
        left: 0;
        width: 215px;
        border: solid 1px #e0e0e0;
    }

        #Table td {
            height: 0.6rem;
            padding-left: 15px;
        }
    /*條件搜尋*/
</style>

<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<section class="section jarallax text-white" data-jarallax data-speed="0.5" style="padding-top: 50px; padding-bottom: 50px; background: linear-gradient(20deg, rgb(191, 53, 157), rgb(220, 76, 53), rgb(253, 255, 129)) rgb(191, 53, 157);">
    @*<img class="section-background-image jarallax-img" src="~/img/pngtree-red-gold-stock.png" alt="background image" />*@
    <div class="section-background-color" style="background-color: rgba(0, 0, 0, 0.2)"></div>
    <div class="section-content container text-left  d-flex flex-column align-items-center">
        @*<span class="badge badge-pill badge-ghost fs-1 font-family-secondary text-uppercase font-weight-bold letter-spacing-caption">
                Easy 3 steps online booking
            </span>*@
        <h1 class="nav justify-content-lg-center tracking-in-contract">討論區</h1>
    </div>
</section>
<br />
<br />


<div class="container center">
    @if (Request.IsAuthenticated)
    {
        // 有登入 @User.Identity.GetUserName() @User.Identity.GetNickName() @User.Identity.GetStockBag()
    <h2>篩選文章 <input type="text" id="filter" placeholder="輸入代號或名稱 篩選文章" onkeyup="filter()" /><span class="pull-right"><button id="newItem" class="btn btn-outline-success btn-sm">發文</button></span></h2>
        <button id="btnName" data-UserName="@User.Identity.GetNickName()" hidden></button>
        <button id="btnID" data-UserName="@User.Identity.GetUserName()" hidden></button>
        @*發文在這*@
        <div class="panel-group ">
            @foreach (message message in messageList)
            {
                List<message> articleList = new List<message>();
                if (message.replyID == 0)
                {
                    articleList.Add(message);
                }
                foreach (message article in articleList)
                {
                    //文章區塊
                    <div class="panel panel-primary msg" id="@article.messageID" data-hashtag="@article.hashtagID">
                        @*文章頭*@
                        <div class="panel-heading">
                            @article.UserName
                            @*編輯紐*@
                            <div class="dropdown">
                                <label for="op+@article.messageID"><img width="20" height="20" class="img img-base img-res dropdown" data-src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" lazy="loaded"></label>
                                <button class="dropbtn" id="op+@article.messageID" hidden onclick="drop(this)" data-messageID="@article.messageID" data-UserName="@article.UserName" name="test"><img width="20" height="20" class="img img-base img-res dropdown" data-src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" lazy="loaded"></button>
                                <div id="myDropdown+@article.messageID" class="dropdown-content">
                                    <button onclick="edit(this)" class="btnEdit" @*data-photoOrg="@article.photo"*@ data-messageID="@article.messageID" data-photo="@string.Format("data:image/gif;base64,{0}",Convert.ToBase64String(article.photo))" data-UserName="@article.UserName" data-main="@article.main">編輯</button>
                                    <button onclick="myDelete(this)" class="btnDelete" data-messageID="@article.messageID">刪除</button>
                                </div>
                                <div id="myDropdown2+@article.messageID" class="dropdown-content">
                                    <button onclick="report(this)" id="report+@article.messageID" data-UserName="@article.UserName">檢舉</button>
                                </div>
                            </div>
                            @*編輯紐*@
                            <span class="pull-right">@article.initDate</span>
                        </div>
                        @*文章頭*@
                        <hr />
                        <div class="panel-body">
                            <div class="panel-content">
                                @*文章內文*@

                                @if (@article.hashtagID.ToString() != "0")
                                {
                                    <a href="/stocks/Chart/@article.hashtagID.Substring(0,4)"><span class="myTag btn btn-outline-dark">@article.hashtagID</span></a>
                                    <br /><br />
                                }
                                @article.main
                                <br /><br />
                                @{if (article.photo.Length > 10)
                                    {
                                        string base64 = Convert.ToBase64String(article.photo);
                                        string imageDate = string.Format("data:image/gif;base64,{0}", base64);
                                        <img class="myPhoto" src="@imageDate" />
                                    }
                                }
                                <br />
                                <hr />
                            </div>
                            <div class="panel-footer">
                                @*文章使用者有沒有案過讚*@
                                @if (article.wholike.Contains(@User.Identity.GetUserName()))
                                {
                                    @*Toggle Switch*@
                                    <input type="checkbox" class="switch switchHeart" id="heart+@article.messageID" data-UserName="@User.Identity.GetUserName()" data-heart="@article.heart" data-messageID="@article.messageID" onchange="heartChange(this)" checked />
                                    <label for="heart+@article.messageID">
                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                            <g id="like+@article.messageID" class="style-scope yt-icon">
                                                <path d="M3,11h3v10H3V11z M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11v10h10.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z" class="style-scope yt-icon">
                                                </path>
                                            </g>
                                        </svg>
                                    </label>
                                    <span id="heartCnt+@article.messageID" data-heart="@article.heart" data-messageID="@article.messageID">推 @article.heart</span>
                                    @*Toggle Switch*@
                                }
                                else
                                {
                                    @*Toggle Switch*@
                                    <input type="checkbox" class="switch switchHeart" id="heart+@article.messageID" data-UserName="@User.Identity.GetUserName()" data-heart="@article.heart" data-messageID="@article.messageID" onchange="heartChange(this)" />
                                    <label for="heart+@article.messageID">
                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                            <g id="like+@article.messageID" class="style-scope yt-icon">
                                                <path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon">
                                                </path>
                                            </g>
                                        </svg>
                                    </label>
                                    <span id="heartCnt+@article.messageID" data-heart="@article.heart" data-messageID="@article.messageID">推 @article.heart</span>
                                    @*Toggle Switch*@
                                }
                                @*文章使用者有沒有案過讚*@
                                @*文章使用者有沒有案過噓*@
                                @if (article.whohate.Contains(@User.Identity.GetUserName()))
                                {
                                    @*Toggle Switch *@
                                    <input type="checkbox" class="switch switchDislike" id="dislike+@article.messageID" data-UserName="@User.Identity.GetUserName()" data-dislike="@article.dislike" data-messageID="@article.messageID" onchange="dislikeChange(this)" checked />
                                    <label for="dislike+@article.messageID">
                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                            <g id="hate+@article.messageID" class="style-scope yt-icon">
                                                <path d="M18,4h3v10h-3V4z M5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21c0.58,0,1.14-0.24,1.52-0.65L17,14V4H6.57 C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14z" class="style-scope yt-icon">
                                                </path>
                                            </g>
                                        </svg>
                                    </label>
                                    <span id="dislikeCnt+@article.messageID" data-dislike="@article.dislike" data-messageID="@article.messageID">噓 @article.dislike</span>
                                    @*Toggle Switch *@
                                }
                                else
                                {
                                    @*Toggle Switch*@
                                    <input type="checkbox" class="switch switchDislike" id="dislike+@article.messageID" data-UserName="@User.Identity.GetUserName()" data-dislike="@article.dislike" data-messageID="@article.messageID" onchange="dislikeChange(this)" />
                                    <label for="dislike+@article.messageID">
                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                            <g id="hate+@article.messageID" class="style-scope yt-icon">
                                                <path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon">
                                                </path>
                                            </g>
                                        </svg>
                                    </label>
                                    <span id="dislikeCnt+@article.messageID" data-dislike="@article.dislike" data-messageID="@article.messageID">噓 @article.dislike</span>
                                    @*Toggle Switch*@
                                }
                                @*文章使用者有沒有案過噓*@
                                <button class="btn btnRelpy btn-outline-dark pull-right " data-messageID="@article.messageID"><p>回覆</p></button>
                            </div>
                            <br />
                            @*文章區塊*@

                            @*回覆區塊*@
                            @foreach (message reply in messageList)
                            {
                                if (reply.replyID == article.messageID)
                                {
                                    <div class="panel panel-info rpl" id="@reply.messageID">
                                        @*回覆頭*@
                                        <div class="panel-heading">
                                            @reply.UserName
                                            @*編輯紐*@
                                            <div class="dropdown">
                                                <label for="op+@reply.messageID"><img width="20" height="20" class="img img-base img-res dropdown" data-src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" lazy="loaded"></label>
                                                <button class="dropbtn" id="op+@reply.messageID" hidden onclick="drop(this)" data-messageID="@reply.messageID" data-UserName="@reply.UserName" name="test"><img width="20" height="20" class="img img-base img-res dropdown" data-src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" lazy="loaded"></button>
                                                <div id="myDropdown+@reply.messageID" class="dropdown-content">
                                                    <button onclick="edit(this)" class="btnEdit" data-messageID="@reply.messageID" data-UserName="@reply.UserName" data-main="@reply.main">編輯</button>
                                                    <button onclick="myDelete(this)" class="btnDelete" data-messageID="@reply.messageID">刪除</button>
                                                </div>
                                                <div id="myDropdown2+@reply.messageID" class="dropdown-content">
                                                    <button onclick="report(this)">檢舉</button>
                                                </div>
                                            </div>
                                            @*編輯紐*@<span class="pull-right">@reply.initDate</span>
                                        </div>
                                        @*回覆頭*@
                                        <hr />
                                        <div class="panel-body">
                                            @*回覆內文*@
                                            <div class="panel-content">

                                                @reply.main
                                                <br />
                                            </div>
                                            @*回覆內文*@
                                            <div class="panel-footer">
                                                @*回覆使用者有沒有案過讚*@
                                                @if (reply.wholike.Contains(@User.Identity.GetUserName()))
                                                {
                                                    @*有案讚*@
                                                    <input type="checkbox" class="switch switchHeart" id="heart+@reply.messageID" data-UserName="@User.Identity.GetUserName()" data-heart="@reply.heart" data-messageID="@reply.messageID" onchange="heartChange(this)" checked />
                                                    <label for="heart+@reply.messageID">
                                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                            <g id="like+@reply.messageID" class="style-scope yt-icon">
                                                                <path d="M3,11h3v10H3V11z M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11v10h10.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z" class="style-scope yt-icon">
                                                                </path>
                                                            </g>
                                                        </svg>
                                                    </label>
                                                    <span id="heartCnt+@reply.messageID" data-heart="@reply.heart" data-messageID="@reply.messageID">推 @reply.heart</span>
                                                    @*Toggle Switch*@
                                                }
                                                else
                                                {
                                                    @*沒按讚*@
                                                    <input type="checkbox" class="switch switchHeart" id="heart+@reply.messageID" data-UserName="@User.Identity.GetUserName()" data-heart="@reply.heart" data-messageID="@reply.messageID" onchange="heartChange(this)" />
                                                    <label for="heart+@reply.messageID">
                                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                            <g id="like+@reply.messageID" class="style-scope yt-icon">
                                                                <path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon">
                                                                </path>
                                                            </g>
                                                        </svg>
                                                    </label>
                                                    <span id="heartCnt+@reply.messageID" data-heart="@reply.heart" data-messageID="@reply.messageID">推 @reply.heart</span>
                                                    @*Toggle Switch*@
                                                }
                                                @*回覆使用者有沒有案過讚*@
                                                @*回覆使用者有沒有案過噓*@
                                                @if (reply.whohate.Contains(@User.Identity.GetUserName()))
                                                {
                                                    @*Toggle Switch *@
                                                    <input type="checkbox" class="switch switchDislike" id="dislike+@reply.messageID" data-UserName="@User.Identity.GetUserName()" data-dislike="@reply.dislike" data-messageID="@reply.messageID" onchange="dislikeChange(this)" checked />
                                                    <label for="dislike+@reply.messageID">
                                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                            <g id="hate+@reply.messageID" class="style-scope yt-icon">
                                                                <path d="M18,4h3v10h-3V4z M5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21c0.58,0,1.14-0.24,1.52-0.65L17,14V4H6.57 C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14z" class="style-scope yt-icon">
                                                                </path>
                                                            </g>
                                                        </svg>
                                                    </label>
                                                    <span id="dislikeCnt+@reply.messageID" data-dislike="@reply.dislike" data-messageID="@reply.messageID">噓 @reply.dislike</span>
                                                    @*Toggle Switch *@
                                                }
                                                else
                                                {
                                                    @*Toggle Switch*@
                                                    <input type="checkbox" class="switch switchDislike" id="dislike+@reply.messageID" data-UserName="@User.Identity.GetUserName()" data-dislike="@reply.dislike" data-messageID="@reply.messageID" onchange="dislikeChange(this)" />
                                                    <label for="dislike+@reply.messageID">
                                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                            <g id="hate+@reply.messageID" class="style-scope yt-icon">
                                                                <path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon">
                                                                </path>
                                                            </g>
                                                        </svg>
                                                    </label>
                                                    <span id="dislikeCnt+@reply.messageID" data-dislike="@reply.dislike" data-messageID="@reply.messageID">噓 @reply.dislike</span>
                                                    @*Toggle Switch*@
                                                }
                                                @*回覆使用者有沒有案過噓*@
                                                <button class="btn btnRelpy btn-outline-dark pull-right " data-messageID="@reply.messageID"><p>回覆</p></button>
                                            </div>
                                            <br />
                                            @foreach (var replyToReply in messageList)
                                            {
                                                if (replyToReply.replyID == reply.messageID)
                                                {
                                                    <div class="panel panel-info torpl" id="@replyToReply.messageID">
                                                        <div class="panel-heading">
                                                            @replyToReply.UserName
                                                            @*編輯紐*@
                                                            <div class="dropdown">
                                                                <label for="op+@replyToReply.messageID"><img width="20" height="20" class="img img-base img-res dropdown" data-src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" lazy="loaded"></label>
                                                                <button class="dropbtn" id="op+@replyToReply.messageID" hidden onclick="drop(this)" data-messageID="@replyToReply.messageID" data-UserName="@replyToReply.UserName" name="test"><img width="20" height="20" class="img img-base img-res dropdown" data-src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMxLjEyMTMgMTcuODc4N0MzMi4yOTI5IDE5LjA1MDIgMzIuMjkyOSAyMC45NDk3IDMxLjEyMTMgMjIuMTIxM0MyOS45NDk3IDIzLjI5MjkgMjguMDUwMiAyMy4yOTI5IDI2Ljg3ODcgMjIuMTIxM0MyNS43MDcxIDIwLjk0OTcgMjUuNzA3MSAxOS4wNTAyIDI2Ljg3ODcgMTcuODc4N0MyOC4wNTAyIDE2LjcwNzEgMjkuOTQ5NyAxNi43MDcxIDMxLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTIyLjEyMTMgMTcuODc4N0MyMy4yOTI5IDE5LjA1MDIgMjMuMjkyOSAyMC45NDk3IDIyLjEyMTMgMjIuMTIxM0MyMC45NDk3IDIzLjI5MjkgMTkuMDUwMiAyMy4yOTI5IDE3Ljg3ODcgMjIuMTIxM0MxNi43MDcxIDIwLjk0OTcgMTYuNzA3MSAxOS4wNTAyIDE3Ljg3ODcgMTcuODc4N0MxOS4wNTAyIDE2LjcwNzEgMjAuOTQ5NyAxNi43MDcxIDIyLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTEzLjEyMTMgMTcuODc4N0MxNC4yOTI5IDE5LjA1MDIgMTQuMjkyOSAyMC45NDk3IDEzLjEyMTMgMjIuMTIxM0MxMS45NDk3IDIzLjI5MjkgMTAuMDUwMiAyMy4yOTI5IDguODc4NjggMjIuMTIxM0M3LjcwNzExIDIwLjk0OTcgNy43MDcxMSAxOS4wNTAyIDguODc4NjggMTcuODc4N0MxMC4wNTAyIDE2LjcwNzEgMTEuOTQ5NyAxNi43MDcxIDEzLjEyMTMgMTcuODc4N1oiIGZpbGw9IiM4RjhGOEYiLz4KPC9zdmc+Cg==" lazy="loaded"></button>
                                                                <div id="myDropdown+@replyToReply.messageID" class="dropdown-content">
                                                                    <button onclick="edit(this)" class="btnEdit" data-messageID="@replyToReply.messageID" data-UserName="@replyToReply.UserName" data-main="@replyToReply.main">編輯</button>
                                                                    <button onclick="myDelete(this)" class="btnDelete" data-messageID="@replyToReply.messageID">刪除</button>
                                                                </div>
                                                                <div id="myDropdown2+@replyToReply.messageID" class="dropdown-content">
                                                                    <button onclick="report(this)">檢舉</button>
                                                                </div>
                                                            </div>
                                                            @*編輯紐*@<span class="pull-right">@replyToReply.initDate</span>
                                                        </div>
                                                        <hr />
                                                        <div class="panel-body">
                                                            <div class="panel-content">
                                                                @replyToReply.main
                                                                <br />
                                                            </div>
                                                            <div class="panel-footer">
                                                                @*回覆使用者有沒有案過讚*@
                                                                @if (replyToReply.wholike.Contains(@User.Identity.GetUserName()))
                                                                {
                                                                    @*Toggle Switch*@
                                                                    <input type="checkbox" class="switch switchHeart" id="heart+@replyToReply.messageID" data-UserName="@User.Identity.GetUserName()" data-heart="@replyToReply.heart" data-messageID="@replyToReply.messageID" onchange="heartChange(this)" checked />
                                                                    <label for="heart+@replyToReply.messageID">
                                                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                                            <g id="like+@replyToReply.messageID" class="style-scope yt-icon">
                                                                                <path d="M3,11h3v10H3V11z M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11v10h10.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z" class="style-scope yt-icon">
                                                                                </path>
                                                                            </g>
                                                                        </svg>
                                                                    </label>
                                                                    <span id="heartCnt+@replyToReply.messageID" data-heart="@replyToReply.heart" data-messageID="@replyToReply.messageID">推 @replyToReply.heart</span>
                                                                    @*Toggle Switch*@
                                                                }
                                                                else
                                                                {
                                                                    @*Toggle Switch*@
                                                                    <input type="checkbox" class="switch switchHeart" id="heart+@replyToReply.messageID" data-UserName="@User.Identity.GetUserName()" data-heart="@replyToReply.heart" data-messageID="@replyToReply.messageID" onchange="heartChange(this)" />
                                                                    <label for="heart+@replyToReply.messageID">
                                                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                                            <g id="like+@replyToReply.messageID" class="style-scope yt-icon">
                                                                                <path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon">
                                                                                </path>
                                                                            </g>
                                                                        </svg>
                                                                    </label>
                                                                    <span id="heartCnt+@replyToReply.messageID" data-heart="@replyToReply.heart" data-messageID="@replyToReply.messageID">推 @replyToReply.heart</span>
                                                                    @*Toggle Switch*@
                                                                }
                                                                @*回覆使用者有沒有案過讚*@
                                                                @*回覆使用者有沒有案過噓*@
                                                                @if (replyToReply.whohate.Contains(@User.Identity.GetUserName()))
                                                                {
                                                                    @*Toggle Switch *@
                                                                    <input type="checkbox" class="switch switchDislike" id="dislike+@replyToReply.messageID" data-UserName="@User.Identity.GetUserName()" data-dislike="@replyToReply.dislike" data-messageID="@replyToReply.messageID" onchange="dislikeChange(this)" checked />
                                                                    <label for="dislike+@replyToReply.messageID">
                                                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                                            <g id="hate+@replyToReply.messageID" class="style-scope yt-icon">
                                                                                <path d="M18,4h3v10h-3V4z M5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21c0.58,0,1.14-0.24,1.52-0.65L17,14V4H6.57 C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14z" class="style-scope yt-icon">
                                                                                </path>
                                                                            </g>
                                                                        </svg>
                                                                    </label>
                                                                    <span id="dislikeCnt+@replyToReply.messageID" data-dislike="@replyToReply.dislike" data-messageID="@replyToReply.messageID">噓 @replyToReply.dislike</span>
                                                                    @*Toggle Switch *@
                                                                }
                                                                else
                                                                {
                                                                    @*Toggle Switch*@
                                                                    <input type="checkbox" class="switch switchDislike" id="dislike+@replyToReply.messageID" data-UserName="@User.Identity.GetUserName()" data-dislike="@replyToReply.dislike" data-messageID="@replyToReply.messageID" onchange="dislikeChange(this)" />
                                                                    <label for="dislike+@replyToReply.messageID">
                                                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                                            <g id="hate+@replyToReply.messageID" class="style-scope yt-icon">
                                                                                <path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon">
                                                                                </path>
                                                                            </g>
                                                                        </svg>
                                                                    </label>
                                                                    <span id="dislikeCnt+@replyToReply.messageID" data-dislike="@replyToReply.dislike" data-messageID="@replyToReply.messageID">噓 @replyToReply.dislike</span>
                                                                    @*Toggle Switch*@
                                                                }
                                                                @*回覆使用者有沒有案過噓*@
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                            @*<button class="btntest btnHeart+@reply.messageID btn btn-success" id="heart+@reply.messageID" AutoPostBack="true" data-messageID="@reply.messageID" data-heart="@reply.heart" alt="Add Password">推 @reply.heart</button>
                                                <button class="btntest btnDislike+@reply.messageID btn btn-danger" id="dislike+@reply.messageID" AutoPostBack="true" data-messageID="@reply.messageID" data-dislike="@reply.dislike" alt="Add Password">噓 @reply.dislike</button>*@
                                        </div>
                                    </div>
                                }
                            }
                            @*回覆區塊*@
                        </div>
                    </div>
                }
            }
        </div>
        @*發文結束*@
    }
    else
    {
        //  沒登入 @User.Identity.GetUserName()
        <h2>討論區<span class="pull-right"><button id="newItem" class="btn btn-outline-success btn-sm" onclick="login()"> @Html.ActionLink("發文", "Login", "Account")</button></span></h2>
        @*發文在這*@
        <div class="panel-group">
            @foreach (message message in messageList)
            {
                List<message> articleList = new List<message>();
                if (message.replyID == 0)
                {
                    articleList.Add(message);
                }
                foreach (message article in articleList)
                {
                    <div class="panel panel-primary msg">

                        <div class="panel-heading">@article.UserName<span class="pull-right">@article.initDate</span></div>
                        <hr />
                        <div class="panel-body">
                            <div class="panel-content">
                                @if (@article.hashtagID != "0")
                                {
                                    <a href="/stocks/Chart/@article.hashtagID"><span class="myTag btn btn-outline-dark">@article.hashtagID</span></a>
                                    <br /><br />
                                }
                                @article.main
                                <br /><br />
                                @{if (article.photo.Length > 10)
                                    {
                                        string base64 = Convert.ToBase64String(article.photo);
                                        string imageDate = string.Format("data:image/gif;base64,{0}", base64);
                                        <img class="myPhoto" src="@imageDate" />
                                    }
                                }
                                <br />
                                <hr />
                            </div>
                            <div class="panel-footer">
                                @*Toggle Switch*@
                                <input type="checkbox" class="switch switchHeart" id="heart+@article.messageID" data-UserName="@User.Identity.GetUserName()" data-heart="@article.heart" data-messageID="@article.messageID" onchange="login()" />
                                <label for="heart+@article.messageID">
                                    <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                        <g id="like+@article.messageID" class="style-scope yt-icon">
                                            <path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon">
                                            </path>
                                        </g>
                                    </svg>
                                </label>
                                <span id="heartCnt+@article.messageID" data-heart="@article.heart" data-messageID="@article.messageID">推 @article.heart</span>
                                @*Toggle Switch*@
                                @*Toggle Switch*@
                                <input type="checkbox" class="switch switchDislike" id="dislike+@article.messageID" />
                                <label for="dislike+@article.messageID">
                                    <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                        <g id="hate+@article.messageID" class="style-scope yt-icon">
                                            <path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon">
                                            </path>
                                        </g>
                                    </svg>
                                </label>
                                <span>噓 @article.dislike</span>
                                @*Toggle Switch*@
                                <a href="/Account/Login"><span class="btn btn-outline-dark pull-right myTag">回覆</span></a>

                            </div>
                            <br />

                        </div>
                        @*回覆在這*@
                        @foreach (message reply in messageList)
                        {
                            if (reply.replyID == article.messageID)
                            {

                                <div class="panel panel-info rpl">
                                    <div class="panel-heading">@reply.UserName<span class="pull-right">@reply.initDate</span></div>
                                    <hr />
                                    <div class="panel-body">
                                        <div class="panel-content">
                                            @reply.main
                                            <br />
                                        </div>
                                        <div class="panel-footer">
                                            @*Toggle Switch*@
                                            <input type="checkbox" class="switch switchHeart" id="heart+@reply.messageID" data-UserName="@User.Identity.GetUserName()" data-heart="@reply.heart" data-messageID="@reply.messageID" onchange="heartChange(this)" />
                                            <label for="heart+@reply.messageID">
                                                <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                    <g id="like+@reply.messageID" class="style-scope yt-icon">
                                                        <path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon">
                                                        </path>
                                                    </g>
                                                </svg>
                                            </label>
                                            <span id="heartCnt+@reply.messageID" data-heart="@reply.heart" data-messageID="@reply.messageID">推 @reply.heart</span>
                                            @*Toggle Switch*@
                                            @*Toggle Switch*@
                                            <input type="checkbox" class="switch switchDislike" id="dislike+@reply.messageID" data-UserName="@User.Identity.GetUserName()" data-dislike="@reply.dislike" data-messageID="@reply.messageID" onchange="dislikeChange(this)" />
                                            <label for="dislike+@reply.messageID">
                                                <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                    <g id="hate+@reply.messageID" class="style-scope yt-icon">
                                                        <path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon">
                                                        </path>
                                                    </g>
                                                </svg>
                                            </label>
                                            <span id="dislikeCnt+@reply.messageID" data-dislike="@reply.dislike" data-messageID="@reply.messageID">噓 @reply.dislike</span>
                                            @*Toggle Switch*@
                                            <a href="/Account/Login"><span class="btn btn-outline-dark pull-right myTag">回覆</span></a>
                                        </div>
                                        @*<button class="btntest btnHeart+@reply.messageID btn btn-success" id="heart+@reply.messageID" AutoPostBack="true" data-messageID="@reply.messageID" data-heart="@reply.heart" alt="Add Password">推 @reply.heart</button>
                                            <button class="btntest btnDislike+@reply.messageID btn btn-danger" id="dislike+@reply.messageID" AutoPostBack="true" data-messageID="@reply.messageID" data-dislike="@reply.dislike" alt="Add Password">噓 @reply.dislike</button>*@
                                    </div>
                                    @foreach (var replyToReply in messageList)
                                    {
                                        if (replyToReply.replyID == reply.messageID)
                                        {
                                            <div class="panel panel-info torpl">
                                                <div class="panel-heading">@replyToReply.UserName<span class="pull-right">@replyToReply.initDate</span></div>
                                                <hr />
                                                <div class="panel-body">
                                                    <div class="panel-content">
                                                        @replyToReply.main
                                                        <br />
                                                    </div>
                                                    <div class="panel-footer">
                                                        @*Toggle Switch*@
                                                        <input type="checkbox" class="switch switchHeart" id="heart+@replyToReply.messageID" data-UserName="@User.Identity.GetUserName()" data-heart="@replyToReply.heart" data-messageID="@replyToReply.messageID" onchange="heartChange(this)" />
                                                        <label for="heart+@replyToReply.messageID">
                                                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                                <g id="like+@replyToReply.messageID" class="style-scope yt-icon">
                                                                    <path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon">
                                                                    </path>
                                                                </g>
                                                            </svg>
                                                        </label>
                                                        <span id="heartCnt+@replyToReply.messageID" data-heart="@replyToReply.heart" data-messageID="@replyToReply.messageID">推 @replyToReply.heart</span>
                                                        @*Toggle Switch*@
                                                        @*Toggle Switch*@
                                                        <input type="checkbox" class="switch switchDislike" id="dislike+@replyToReply.messageID" data-UserName="@User.Identity.GetUserName()" data-dislike="@replyToReply.dislike" data-messageID="@replyToReply.messageID" onchange="dislikeChange(this)" />
                                                        <label for="dislike+@replyToReply.messageID">
                                                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 20px; height: 20px;">
                                                                <g id="hate+@replyToReply.messageID" class="style-scope yt-icon">
                                                                    <path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon">
                                                                    </path>
                                                                </g>
                                                            </svg>
                                                        </label>
                                                        <span id="dislikeCnt+@replyToReply.messageID" data-dislike="@replyToReply.dislike" data-messageID="@replyToReply.messageID">噓 @replyToReply.dislike</span>
                                                        @*Toggle Switch*@

                                                    </div>
                                                </div>

                                            </div>

                                        }

                                    }
                                </div>

                            }
                        }
                        @*回覆結束*@
                    </div>
                }
            }
        </div>
        @*發文結束*@
    }


    @*<script src="https://cdn.ckeditor.com/4.7.3/standard/ckeditor.js"></script>*@

    <!-- 新增貼文 -->
    <div id="newsModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">發文</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/Home/Message" enctype="multipart/form-data">
                        <div class="form-group">
                            @*<label for="UserNameBox">*@
                            <span class="glyphicon glyphicon-bullhorn"></span>
                            使用者名稱
                            @*</label>*@
                            <input type="text"
                                   name="UserNameBox"
                                   class="form-control"
                                   placeholder="使用者名稱"
                                   value="@User.Identity.GetNickName()"
                                   readonly />
                        </div>

                        <div class="msginfo" id="hashtagBox">
                            <span class="glyphicon glyphicon-time" id="thinking">想標記個股嗎?</span>
                            <div class="btnSearch pull-right">
                                <section class="search" id="search2">
                                    <div class="row dddd">
                                        <input type="text" class="form-control-sm mb-3 pull-right" onkeyup="tipBox1(this)" autocomplete="off" placeholder="股票代碼..." id="hashtagStock" name="hashtagStock">
                                        <button id="hashtag" type="button" onclick="confirmHashtag()" class="pull-right" style="border:0px; background-color:white; position:relative; display:inline-block">
                                            <i class="material-icons" aria-hidden="true">search </i>
                                        </button>
                                    </div>
                                </section>
                            </div>
                        </div>

                        <div class="form-group">
                            @*<label for="mainBox">*@

                            @*</label>*@
                            <input type="text"
                                   id="UserIdbox"
                                   name="UserIdbox"
                                   value="@User.Identity.GetUserName()"
                                   hidden>
                            @*<input type="text"
                                name="hashtagBox"
                                id="hashtagBoxID"
                                value=""
                                hidden />*@
                            <textarea class="form-control"
                                      name="mainBox"
                                      id="exampleFormControlTextarea1"
                                      placeholder="在想些什麼呢?"
                                      rows="3"></textarea>
                            <input type="file" accept=".png, .jpg, .jpeg" name="imageBox" id="imageBox" onchange="setPreview(this)" />
                            <img id="preview" src="#" />
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                            <button type="submit" class="btn btn-primary">發文</button>
                        </div>

                    </form>
                </div>

            </div>
        </div>
    </div>
    <!-- 新增貼文 -->
    <!-- 回覆貼文 -->
    <div id="replyModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">回覆</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/Home/Reply">
                        <div>
                            <input type="text" id="messageID" name="messageID" value="0" hidden />
                        </div>
                        <div class="form-group">
                            @*<label for="UserNameBox">*@
                            <span class="glyphicon glyphicon-bullhorn"></span>
                            使用者名稱
                            @*</label>*@
                            <input type="text"
                                   name="UserNameBox"
                                   class="form-control"
                                   placeholder="使用者名稱"
                                   value="@User.Identity.GetNickName()"
                                   readonly />
                        </div>

                        <div class="form-group">
                            @*<label for="mainBox">*@
                            <span class="glyphicon glyphicon-time"></span>
                            回覆內容
                            @*</label>*@
                            <input type="text"
                                   name="UserIdbox"
                                   value="@User.Identity.GetUserName()"
                                   hidden>
                            <input type="text"
                                   name="hashtagBox"
                                   value="0"
                                   hidden>
                            <textarea class="form-control"
                                      name="mainBox"
                                      id="exampleFormControlTextarea1"
                                      rows="3"></textarea>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                            <button type="submit" class="btn btn-outline-success ">回覆</button>
                        </div>

                    </form>
                </div>

            </div>
        </div>
    </div>
    <!-- 回覆貼文 -->
    <!-- 編輯貼文 -->
    <div id="editModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">編輯</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/Home/Edit" enctype="multipart/form-data">
                        <div>
                            <input type="text" id="EditmessageID" name="messageID" value="0" hidden />
                        </div>
                        <div class="form-group">
                            @*<label for="UserNameBox">*@
                            <span class="glyphicon glyphicon-bullhorn"></span>
                            使用者名稱
                            @*</label>*@
                            <input type="text"
                                   name="UserNameBox"
                                   class="form-control"
                                   placeholder="使用者名稱"
                                   value="@User.Identity.GetNickName()"
                                   readonly />
                        </div>

                        <div class="form-group">
                            @*<label for="mainBox">*@
                            <span class="glyphicon glyphicon-time"></span>
                            原始內容
                            @*</label>*@
                            <input type="text"
                                   name="UserIdbox"
                                   value="@User.Identity.GetUserName()"
                                   hidden>
                            <textarea class="form-control"
                                      name="mainBox"
                                      id="editMain"
                                      value=""
                                      rows="3"></textarea>
                            <input type="file" accept=".png, .jpg, .jpeg" name="imageBoxEdit" id="imageBoxEdit" onchange="setPreview1(this)" />
                            <img id="previewEdit" src="#" />
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                            <button type="submit" class="btn btn-outline-success ">編輯</button>
                        </div>

                    </form>
                </div>

            </div>
        </div>
    </div>
    <!-- 編輯貼文 -->
    <!-- 檢舉貼文 -->
    <div id="reportModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">檢舉</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/Home/Report">
                        <div>
                            <input type="text" id="ReportmessageID" name="messageID" value="0" hidden />
                        </div>
                        <div class="form-group">
                            @*<label for="UserNameBox">*@
                            <span class="glyphicon glyphicon-bullhorn"></span>
                            檢舉使用者名稱
                            @*</label>*@
                            <input type="text"
                                   id="reportUserName"
                                   name="UserNameBox"
                                   class="form-control"
                                   placeholder="檢舉使用者名稱"
                                   value=""
                                   readonly />
                        </div>

                        <div class="form-group">
                            @*<label for="mainBox">*@
                            <span class="glyphicon glyphicon-time"></span>
                            檢舉原因
                            @*</label>*@
                            <input type="text"
                                   name="UserIdbox"
                                   value="@User.Identity.GetUserName()"
                                   hidden>
                            <textarea class="form-control"
                                      name="mainBox"
                                      id="reportResult"
                                      value=""
                                      rows="3"></textarea>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                            <button type="button" class="btn btn-outline-success Report">檢舉</button>
                        </div>

                    </form>
                </div>

            </div>
        </div>
    </div>
    <!-- 檢舉貼文 -->
    <!-- 檢舉貼文 -->
    <div id="MyReportModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">檢舉</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/Home/Report">
                        <div>
                            <input type="text" id="ReportmessageID" name="messageID" value="0" hidden />
                        </div>
                        <div class="form-group">
                            <span>感謝您的回饋，我們會再審視這則訊息，<br />如果我們認為該內容確實違反《社群規範》，就會將其移除。</span>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                            <button type="button" class="btn btn-outline-success btnOK">確認</button>
                        </div>

                    </form>
                </div>

            </div>
        </div>
    </div>
    <!-- 檢舉貼文 -->
</div>
@*<script>CKEDITOR.replace("mainBox");</script>*@
@*<script>CKEDITOR.replace("UserIdbox");</script>*@
<script src="~/Scripts/bootstrap.min.js"></script>
<script src="~/Scripts/jquery-3.4.1.js"></script>
<script src="~/Content/vendor.css"></script>

<script>
    let name = document.getElementById('btnName').dataset.username
    let ID = document.getElementById('btnID').dataset.username
    $("#newItem").click(function () {
        $("#newsModal").modal({ backdrop: "static" });
    })

    $(".btnRelpy").click(function () {
        $("#messageID").val(this.dataset.messageid);
        $("#replyModal").modal({ backdrop: "static" });
    })
    $(".btnEdit").click(function () {
        $("#EditmessageID").val(this.dataset.messageid);
        $("#editMain").val(this.dataset.main);
        $("#editModal").modal({ backdrop: "static" });
        $("#previewEdit").attr('src', this.dataset.photo);
        /*$("#imageOrg").val(this.dataset.photoOrg);*/
        //var reader = new FileReader();
        //reader.onload = function (e) {
        //    $('#previewEdit')
        //        .attr('src', e.target.result)
        //        .maxHeight(150) // 設定圖片最大高度

        //        .maxWidth(200); // 設定圖片最大寬度

    })
    $(".Report").click(function () {
        $("#reportResult").val("");
        $("#reportModal").modal('hide');
        $("#MyReportModal").modal({ backdrop: "static" });
    })
    $(".btnOK").click(function () {
        $("#MyReportModal").modal('hide');
    })
    function report(btn) {
        $("#reportModal").modal({ backdrop: "static" });
        /*console.log(btn.dataset.username);*/
        $("#reportUserName").val(btn.dataset.username);

    }

    $(".btntest").click(function () {
        var message = {
            messageID: 0,
            heart: -1,
            dislike: -1
        }
        message.messageID = this.dataset.messageid;
        message.heart = this.dataset.heart;
        message.dislike = this.dataset.dislike;
        if (message.heart) {
            //alert("true")
            console.log(message.heart);
            console.log(message.dislike);
            console.log('message.heart != -1');
            $.ajax({
                type: "post",
                url: "/Home/APILike",
                data: message
            }).then(function (e) {
                document.getElementById(`heart+${message.messageID}`).innerHTML = `讚 ${e.heart}`;
                document.getElementById(`heart+${message.messageID}`).dataset.heart = e.heart;
            })
        }
        else {
            console.log(message.heart);
            console.log(message.dislike);
            console.log('else');
            //alert("false")
            $.ajax({
                type: "post",
                url: "/Home/APIDislike",
                data: message
            }).then(function (e) {
                document.getElementById(`dislike+${message.messageID}`).innerHTML = `倒讚 ${e.dislike}`;
                document.getElementById(`dislike+${message.messageID}`).dataset.dislike = e.dislike;
            })
        }

    })

    $('#preview').hide();

    function setPreview(input) {
        $('#preview').show(); // 設定顯示圖片
        console.log($("imageBox").val());
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#preview')
                    .attr('src', e.target.result)
                    .maxHeight(150) // 設定圖片最大高度

                    .maxWidth(200); // 設定圖片最大寬度
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function setPreview1(input) {
        $('#previewEdit').show(); // 設定顯示圖片
        console.log($("imageBoxEdit").val());
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#previewEdit')
                    .attr('src', e.target.result)
                    .maxHeight(150) // 設定圖片最大高度

                    .maxWidth(200); // 設定圖片最大寬度
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
    function login() {
        alert("未登入 請先登入!");
    }

    function heartChange(cb) {
        //console.log(cb.dataset.UserName);
        var message = {
            messageID: 0,
            heart: -1,
            dislike: -1,
            UserName: ID,
            UserId: name
        }
        if (cb.checked) {
            // 案讚
            //console.log(cb.dataset.heart);
            //console.log(`dislike+${cb.dataset.messageid}`);
            // 案讚且噓是亮的 => 噓改暗的 數字-1
            var cbHate = document.getElementById(`dislike+${cb.dataset.messageid}`);
            if (cbHate.checked == true) {
                cbHate.checked = false;
                // 取消噓
                message.messageID = cbHate.dataset.messageid;
                message.dislike = cbHate.dataset.dislike;
                //console.log(message.UserName);
                $.ajax({
                    type: "post",
                    url: "/Home/APIDislikeCancel",
                    data: message
                }).then(function (e) {
                    document.getElementById(`dislikeCnt+${message.messageID}`).innerHTML = `噓 ${e.dislike}`;
                    document.getElementById(`dislike+${message.messageID}`).dataset.dislike = e.dislike;
                    document.getElementById(`dislikeCnt+${message.messageID}`).dataset.dislike = e.dislike;
                    document.getElementById(`hate+${message.messageID}`).innerHTML = `<path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon"></path>`;

                })
            }
            //console.log(cbHate.checked);

            message.messageID = cb.dataset.messageid;
            message.heart = cb.dataset.heart;
            console.log(message.UserName);
            $.ajax({
                type: "post",
                url: "/Home/APILike",
                data: message
            }).then(function (e) {
                document.getElementById(`heartCnt+${message.messageID}`).innerHTML = `推 ${e.heart}`;
                document.getElementById(`heart+${message.messageID}`).dataset.heart = e.heart;
                document.getElementById(`heartCnt+${message.messageID}`).dataset.heart = e.heart;
                document.getElementById(`like+${message.messageID}`).innerHTML = `<path  d="M3,11h3v10H3V11z M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11v10h10.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z" class="style-scope yt-icon"></path>`;

            })

        } else {
            // 取消讚
            message.messageID = cb.dataset.messageid;
            message.heart = cb.dataset.heart;
            //console.log(message.UserName);
            $.ajax({
                type: "post",
                url: "/Home/APILikeCancel",
                data: message
            }).then(function (e) {
                document.getElementById(`heartCnt+${message.messageID}`).innerHTML = `推 ${e.heart}`;
                document.getElementById(`heart+${message.messageID}`).dataset.heart = e.heart;
                document.getElementById(`heartCnt+${message.messageID}`).dataset.heart = e.heart;
                document.getElementById(`like+${message.messageID}`).innerHTML = `<path  d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon"></path>`;
            })
        }
        //console.log(cb.dataset.messageid);

    }

    function dislikeChange(cb) {
        var message = {
            messageID: 0,
            heart: -1,
            dislike: -1,
            UserName: ID,
            UserId: name
        }
        if (cb.checked) {
            // 案噓
            //console.log(cb.dataset.heart);
            //console.log(cb.dataset.messageid);
            // 案噓且讚是亮的 => 讚改暗的 數字-1
            var cbLike = document.getElementById(`heart+${cb.dataset.messageid}`);
            if (cbLike.checked == true) {
                cbLike.checked = false;
                // 取消讚
                message.messageID = cbLike.dataset.messageid;
                message.heart = cbLike.dataset.heart;
                //console.log(message.UserName);
                $.ajax({
                    type: "post",
                    url: "/Home/APILikeCancel",
                    data: message
                }).then(function (e) {
                    document.getElementById(`heartCnt+${message.messageID}`).innerHTML = `推 ${e.heart}`;
                    document.getElementById(`heart+${message.messageID}`).dataset.heart = e.heart;
                    document.getElementById(`heartCnt+${message.messageID}`).dataset.heart = e.heart;
                    document.getElementById(`like+${message.messageID}`).innerHTML = `<path  d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon"></path>`;
                })
            }
            message.messageID = cb.dataset.messageid;
            message.dislike = cb.dataset.dislike;
            console.log(message.UserName);
            $.ajax({
                type: "post",
                url: "/Home/APIDislike",
                data: message
            }).then(function (e) {
                document.getElementById(`dislikeCnt+${message.messageID}`).innerHTML = `噓 ${e.dislike}`;
                document.getElementById(`dislike+${message.messageID}`).dataset.dislike = e.dislike;
                document.getElementById(`dislikeCnt+${message.messageID}`).dataset.dislike = e.dislike;
                document.getElementById(`hate+${message.messageID}`).innerHTML = `<path d="M18,4h3v10h-3V4z M5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21c0.58,0,1.14-0.24,1.52-0.65L17,14V4H6.57 C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14z" class="style-scope yt-icon"></path>`;

            })

        } else {
            // 取消噓
            message.messageID = cb.dataset.messageid;
            message.dislike = cb.dataset.dislike;
            //console.log(message.UserName);
            $.ajax({
                type: "post",
                url: "/Home/APIDislikeCancel",
                data: message
            }).then(function (e) {
                document.getElementById(`dislikeCnt+${message.messageID}`).innerHTML = `噓 ${e.dislike}`;
                document.getElementById(`dislike+${message.messageID}`).dataset.dislike = e.dislike;
                document.getElementById(`dislikeCnt+${message.messageID}`).dataset.dislike = e.dislike;
                document.getElementById(`hate+${message.messageID}`).innerHTML = `<path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon"></path>`;

            })
        }
    }

    function confirmHashtag() {

        var stockid = $("#hashtagStock").val();
        if (stockid == "") {
            //alert("請輸入股票代號")
            $("#thinking").text("請輸入股票代號!!!!!!");
            $("#thinking").addClass("btn btn-outline-danger");
        } else {
            $("#UserIdbox").after(`<input type="text" name = "hashtagBox" id = "hashtagBoxid" value = "${stockid}" hidden >`);
            //$("#hashtagBoxid").val(stockid);
            // alert(stockid);
            $("#hashtagBox").html(`<button type="button" class="btn btn-outline-dark" onclick="cancelHashtag()" width="40px" id="hashtaged" data-hashtag="${stockid}" value="${stockid}">${stockid}</button>`);
            //console.log($("#hashtagBoxid").val());
        }
    }

    function cancelHashtag() {
        $("#hashtagBox").html('<span class="glyphicon glyphicon-time" id="thinking">想標記個股嗎?</span><div class= "btnSearch pull-right" ><section class="search" id="search2"><div class="row dddd"><input type="text" class="form-control-sm mb-3 pull-right" onkeyup="tipBox1(this)" autocomplete="off" placeholder="股票代碼..." id="hashtagStock" name="hashtagStock"><button id="hashtag" type="button" onclick="confirmHashtag()" class="pull-right" style="border:0px; background-color:white; position:relative; display:inline-block"><i class="material-icons" aria-hidden="true">search </i></button></div></section>');
        $("#hashtagBoxid").remove();
    }

    function drop(btn) {
        //alert("ok");
        if (btn.dataset.username == name) {
            document.getElementById(`myDropdown+${btn.dataset.messageid}`).classList.toggle("show");
        } else {
            document.getElementById(`myDropdown2+${btn.dataset.messageid}`).classList.toggle("show");
        }
        //document.getElementById(`${btn.dataset.messageid}`).classList.toggle("none")
    }

    window.onclick = function (event) {
        if (!event.target.matches('.dropbtn')) {

            var dropdowns = document.getElementsByClassName("dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }

    function myDelete(btn) {
        var message = { messageID: btn.dataset.messageid }
        console.log(btn.dataset.messageid);
        $.ajax({
            type: "post",
            url: "/Home/Delete",
            data: message
        }).then(function (e) {
            document.getElementById(`${btn.dataset.messageid}`).classList.toggle("none")
        })
    }
    // 將資料庫的股票代號資料轉到JS內
    var jScriptArray=[];
        var array = @Html.Raw(Json.Encode(@ViewBag.stockID));
        for(var i = 0; i < array.length; i++) {
            jScriptArray[i] = array[i];
    }
    // 當input text keypu時執行比對 加入提示table
    function tipBox1(txt) {
        QueryKeyword1($(txt).val(), jScriptArray);
        console.log("ok");
    }

    //檢索數組裡是否有對應關鍵詞
    function QueryKeyword1(SearchName, ArrayList) {
        //初始化陣列
        var Keyword = [];
        console.log(array);
        //遍歷陣列內容
        if (parseInt(SearchName).toString() == "NaN") {
            //alert("not a number");
            for (var i = 0; i < ArrayList.length; i++) {
                //查詢判斷陣列內是否包含關鍵詞
                if (SearchName.length != 0) {
                    //中文有包含就輸出
                    if ((ArrayList[i]).includes(SearchName)) {
                        //新增資料
                        Keyword.push(ArrayList[i]);
                        console.log(i);
                    }
                }
            }
        } else {
            //alert("數字");
            for (var i = 0; i < ArrayList.length; i++) {
                //查詢判斷陣列內是否包含關鍵詞
                if (SearchName.length != 0) {
                    //搜尋框輸入資料全等於陣列內字串引數
                    // 數字從頭開始比對
                    if (SearchName === ArrayList[i].substr(0, SearchName.length)) {
                        //新增資料
                        Keyword.push(ArrayList[i]);
                        console.log(i);
                    }
                }
            }
        }

        if (Keyword.length != 0) {
            //建立table表單
            CreateTable1(Keyword);
        } else {
            //刪除table表單
            RemoveTable1();
        }
    }

    //監控table表單點選事件,修改input內容
    function TableOnclick(id) {
        $("#hashtagStock").val($("#" + id).html());
        $("#Table").remove();
        var stockid = $("#hashtagStock").val();
        if (stockid == "") {
            //alert("請輸入股票代號")
            $("#thinking").text("請輸入股票代號!!!!!!");
            $("#thinking").addClass("btn btn-outline-danger");
        } else {
            $("#UserIdbox").after(`<input type="text" name = "hashtagBox" id = "hashtagBoxid" value = "${stockid}" hidden >`);
            //$("#hashtagBoxid").val(stockid);
            // alert(stockid);
            $("#hashtagBox").html(`<button type="button" class="btn btn-outline-dark" onclick="cancelHashtag()" width="40px" id="hashtaged" data-hashtag="${stockid}" value="${stockid}">${stockid}  <img alt="" width="16" height="16" class="img img-base img-res" data-src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iOCIgY3k9IjgiIHI9IjgiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTUuMjk4NjYgMTEuMzI5OUM1LjEzNTIxIDExLjMzOTUgNC45NzQ0NiAxMS4yODQ1IDQuODUwMzIgMTEuMTc2NkM0LjYwNTQ4IDEwLjkyNzQgNC42MDU0OCAxMC41MjUgNC44NTAzMiAxMC4yNzU4TDEwLjIxMTUgNC44NTIyMkMxMC40NjYyIDQuNjExMTYgMTAuODY1OCA0LjYyNDU2IDExLjEwNCA0Ljg4MjE4QzExLjMxOTUgNS4xMTUxNCAxMS4zMzIxIDUuNDczMjEgMTEuMTMzNSA1LjcyMTAyTDUuNzQwNjcgMTEuMTc2NkM1LjYxODEzIDExLjI4MyA1LjQ1OTk2IDExLjMzNzggNS4yOTg2NiAxMS4zMjk5WiIgZmlsbD0iI0YwRjBGMCIvPgo8cGF0aCBkPSJNMTAuNjUzNSAxMS4zMjk5QzEwLjQ4NzkgMTEuMzI5MiAxMC4zMjkxIDExLjI2MjYgMTAuMjExNSAxMS4xNDQ2TDQuODUwMjcgNS43MjEwMUM0LjYyMzQzIDUuNDUzMDQgNC42NTQyNyA1LjA0OTc2IDQuOTE5MTYgNC44MjAyN0M1LjE1NTU4IDQuNjE1NDUgNS41MDQyNSA0LjYxNTQ1IDUuNzQwNjQgNC44MjAyN0wxMS4xMzM0IDEwLjI0MzlDMTEuMzg4IDEwLjQ4NSAxMS40MDEyIDEwLjg4OTMgMTEuMTYyOCAxMS4xNDY4QzExLjE1MzMgMTEuMTU3MSAxMS4xNDM1IDExLjE2NyAxMS4xMzM0IDExLjE3NjZDMTEuMDAxNCAxMS4yOTI3IDEwLjgyNzYgMTEuMzQ4MiAxMC42NTM1IDExLjMyOTlaIiBmaWxsPSIjRjBGMEYwIi8+Cjwvc3ZnPgo=" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iOCIgY3k9IjgiIHI9IjgiIGZpbGw9IiM4RjhGOEYiLz4KPHBhdGggZD0iTTUuMjk4NjYgMTEuMzI5OUM1LjEzNTIxIDExLjMzOTUgNC45NzQ0NiAxMS4yODQ1IDQuODUwMzIgMTEuMTc2NkM0LjYwNTQ4IDEwLjkyNzQgNC42MDU0OCAxMC41MjUgNC44NTAzMiAxMC4yNzU4TDEwLjIxMTUgNC44NTIyMkMxMC40NjYyIDQuNjExMTYgMTAuODY1OCA0LjYyNDU2IDExLjEwNCA0Ljg4MjE4QzExLjMxOTUgNS4xMTUxNCAxMS4zMzIxIDUuNDczMjEgMTEuMTMzNSA1LjcyMTAyTDUuNzQwNjcgMTEuMTc2NkM1LjYxODEzIDExLjI4MyA1LjQ1OTk2IDExLjMzNzggNS4yOTg2NiAxMS4zMjk5WiIgZmlsbD0iI0YwRjBGMCIvPgo8cGF0aCBkPSJNMTAuNjUzNSAxMS4zMjk5QzEwLjQ4NzkgMTEuMzI5MiAxMC4zMjkxIDExLjI2MjYgMTAuMjExNSAxMS4xNDQ2TDQuODUwMjcgNS43MjEwMUM0LjYyMzQzIDUuNDUzMDQgNC42NTQyNyA1LjA0OTc2IDQuOTE5MTYgNC44MjAyN0M1LjE1NTU4IDQuNjE1NDUgNS41MDQyNSA0LjYxNTQ1IDUuNzQwNjQgNC44MjAyN0wxMS4xMzM0IDEwLjI0MzlDMTEuMzg4IDEwLjQ4NSAxMS40MDEyIDEwLjg4OTMgMTEuMTYyOCAxMS4xNDY4QzExLjE1MzMgMTEuMTU3MSAxMS4xNDM1IDExLjE2NyAxMS4xMzM0IDExLjE3NjZDMTEuMDAxNCAxMS4yOTI3IDEwLjgyNzYgMTEuMzQ4MiAxMC42NTM1IDExLjMyOTlaIiBmaWxsPSIjRjBGMEYwIi8+Cjwvc3ZnPgo=" lazy="loaded"></button>`);
            //console.log($("#hashtagBoxid").val());
        }
    }

    //建立table表單
    function CreateTable1(Keyword) {
        var TableContent = "";
        for (var i = 0; i < Keyword.length; i++) {
            TableContent += "" +
                "<tr>" +
                "<td id='" + i + "' onclick='TableOnclick(this.id)'>" + Keyword[i] + "</td>" +
                "</tr>";
        }
        //table表單不存在時進行建立
        if (!document.getElementById("#Table")) {
            var Table1 = document.createElement('table');
            Table1.id = "Table";
            /*Table1.classList.add("Table");*/
            $("#search2").append(Table1);
        }
        $("#Table").html(TableContent);
    }

    //刪除table表單
    function RemoveTable1() {
        $("#Table").remove();
    }

    // 篩選文章
    function filter() {
        if ($("#filter").val() != "") {
            //console.log("有自");
            //console.log($(".msg")[0].dataset.apple);
            //console.log($(".msg").length);
            //console.log($("#filter").val());
            $(".msg").each(function (i) {
                //console.log($(".msg")[i].dataset.hashtag);
                if ($(".msg")[i].dataset.hashtag.length < 5) {
                    //console.log($(".msg")[i].id);
                    document.getElementById($(".msg")[i].id).classList.add("none");
                }
                if (($(".msg")[i].dataset.hashtag).includes($("#filter").val())) {
                    //console.log($(".msg")[i].id);
                    document.getElementById($(".msg")[i].id).classList.remove("none");
                    document.getElementById($(".msg")[i].id).classList.add("show");
                } else {
                    //console.log($(".msg")[i].id);
                    document.getElementById($(".msg")[i].id).classList.remove("show");
                    document.getElementById($(".msg")[i].id).classList.add("none");
                }
            })
        } else {
            //console.log("沒自");
            $(".msg").each(function (i) {
                document.getElementById($(".msg")[i].id).classList.remove("none");
                document.getElementById($(".msg")[i].id).classList.add("show");
            })
        }
    }
</script>
